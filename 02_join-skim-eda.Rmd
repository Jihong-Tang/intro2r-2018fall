---
title: "join, skim, EDA"
output: html_notebook
---

# Load Packages

```{r}
library(tidyverse)
library(skimr)
library(ggvis)
```

# Load Data

Star Wars character data are an onboard part of dplyr:  `dplyr::starwars`



Star Wars survey data are from fivethirtyeight.com.  

- https://github.com/fivethirtyeight/data/tree/master/star-wars-survey
- https://data.fivethirtyeight.com/
- Unless otherwise noted, five thirty eight data sets are available under the Creative Commons Attribution 4.0 International License, and the code is available under the MIT License.

```{}
sw_characters_favorability <- read_csv(
  "https://raw.githubusercontent.com/fivethirtyeight/data/master/star-wars-survey/StarWars.csv", skip = 1)[,16:29]

sw_characters_favorability <- sw_characters_favorability %>% 
  mutate(han = fct_infreq(sw_characters_favorability$`Han Solo`)) %>% 
  rename(luke = `Luke Skywalker`,
         princess = `Princess Leia Organa`) %>% 
  select(han, 2:14)

sw_characters_favorability

```


Load the survey data that deals with character's favorability rating.  

```{r load_data}
sw_characters_favorability <- read_csv(
  "https://raw.githubusercontent.com/fivethirtyeight/data/master/star-wars-survey/StarWars.csv", 
  skip = 1)[,16:29]   # Skip first line due to funky column headers.  [,16:29] ingests columns 16 through 29.

sw_characters_favorability
```




# Skim Data

## Star Wars Charactesr

```{r show_dplyr-starwars-tibble}
starwars
```

## Favorability Data

```{r class_glimpse}
class(sw_characters_favorability)

glimpse(sw_characters_favorability)

# skim(sw_characters_favorability)
```

```{r show_sw-chars-tibble}
sw_characters_favorability
```

# Transform Favorability Data

Get a list of the characters which happen to be the column names

```{r get-colnames}
sw_characters_colnames <- colnames(sw_characters_favorability)
sw_characters_colnames
```

```{r transform-fav-data}

favorability_popularity_rating <- 
  map_dfr(sw_characters_favorability, fct_count) %>% 
  filter(f == "Very favorably") %>% 
  add_column(name = sw_characters_colnames) %>% 
  select(name, fav_rating = n)

favorability_popularity_rating
```


## Join Data


```{r join-data}
sw_joined <- starwars %>% 
  left_join(favorability_popularity_rating, by = "name") %>% 
  select(1, 14, 2:14) %>%
  filter(!is.na(fav_rating))

sw_joined %>% 
  arrange(desc(fav_rating))
```



#  EDA

## Skim

```{r skim-joined}
skim(sw_joined)
```


# Visualize

```{r scatterplot-fav_rating}
sw_joined %>% 
  ggvis(~height, ~fav_rating)
```




